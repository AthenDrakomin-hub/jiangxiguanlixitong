import{j as e}from"./index-BV8Zipq2.js";import{r as o}from"./react-vendor-C14am9Lm.js";import{F as z,l as P,W as O,ad as N,ae as w,m as H,v as I,_ as $,af as E,X as F}from"./lucide-CwzgdtcU.js";import"./aws-sdk-BT5ufFbJ.js";import"./recharts-wRm9IGXD.js";const G=({accounts:m,setAccounts:u})=>{const[h,y]=o.useState(""),[C,x]=o.useState(!1),[d,p]=o.useState(null),[n,b]=o.useState({isOpen:!1,type:"charge",accountId:null}),[g,f]=o.useState(""),[c,i]=o.useState("CASH"),[r,a]=o.useState({name:"",cooperationMethod:"协议单位",settlementMethod:"月结",approver:"",phoneNumber:"",creditLimit:0,currentDebt:0,status:"Active"}),S=m.reduce((t,s)=>t+(s.status==="Active"?s.currentDebt:0),0),A=m.filter(t=>t.status==="Active").length,D=m.filter(t=>t.name.toLowerCase().includes(h.toLowerCase())||t.approver.toLowerCase().includes(h.toLowerCase())),j=t=>{t?(p(t),a(t)):(p(null),a({name:"",cooperationMethod:"协议单位",settlementMethod:"月结",approver:"",phoneNumber:"",creditLimit:0,currentDebt:0,status:"Active"})),x(!0)},k=t=>{if(t.preventDefault(),d)u(s=>s.map(l=>l.id===d.id?{...l,...r}:l));else{const s={...r,id:`SB-${Date.now()}`,currentDebt:r.currentDebt||0,lastTransactionDate:new Date().toISOString()};u(l=>[s,...l])}x(!1)},M=t=>{confirm("Delete this account? 确定要删除该签单账户吗？")&&u(s=>s.filter(l=>l.id!==t))},v=(t,s)=>{b({isOpen:!0,type:s,accountId:t}),f(""),i("CASH")},L=()=>{const t=parseFloat(g);isNaN(t)||t<=0||(u(s=>s.map(l=>{if(l.id===n.accountId){const T=n.type==="charge"?l.currentDebt+t:Math.max(0,l.currentDebt-t);return{...l,currentDebt:T,lastTransactionDate:new Date().toISOString()}}return l})),b({...n,isOpen:!1}))};return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(z,{className:"text-indigo-600"})," 签单管理"]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Manage Corporate Accounts & Settlements"})]}),e.jsxs("button",{onClick:()=>j(),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200",children:[e.jsx(P,{size:20}),e.jsx("span",{children:"New Account 新增账户"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Total Credit 挂账总额"}),e.jsxs("h3",{className:"text-2xl font-bold text-red-600 mt-1",children:["₱",S.toLocaleString()]})]}),e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-lg",children:e.jsx(O,{size:24})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Active Accounts 合作单位"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mt-1",children:A})]}),e.jsx("div",{className:"p-3 bg-indigo-50 text-indigo-600 rounded-lg",children:e.jsx(N,{size:24})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Pending Settlement 待结算"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mt-1",children:m.filter(t=>t.currentDebt>0).length})]}),e.jsx("div",{className:"p-3 bg-slate-100 text-slate-600 rounded-lg",children:e.jsx(w,{size:24})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-slate-100 flex flex-col sm:flex-row gap-4 justify-between items-center",children:e.jsxs("div",{className:"relative w-full sm:w-80",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search Name / 搜索单位或人名...",value:h,onChange:t=>y(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6 bg-slate-50/50",children:D.map(t=>e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm hover:shadow-md transition-shadow relative group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[e.jsx("span",{className:"bg-indigo-50 text-indigo-700 px-2 py-0.5 rounded",children:t.cooperationMethod}),e.jsx("span",{className:"bg-slate-100 text-slate-600 px-2 py-0.5 rounded",children:t.settlementMethod})]})]}),e.jsx("button",{onClick:()=>j(t),className:"text-slate-400 hover:text-indigo-600 p-1",children:e.jsx(I,{size:16})})]}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-600 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(N,{size:14})," Approver 批准人:"]}),e.jsx("span",{className:"font-medium text-slate-800",children:t.approver})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx($,{size:14})," Phone 电话:"]}),e.jsx("span",{className:"font-mono",children:t.phoneNumber})]}),t.creditLimit&&t.creditLimit>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"flex items-center gap-2 text-slate-400",children:"Limit 额度:"}),e.jsxs("span",{className:"font-mono",children:["₱",t.creditLimit.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-0.5",children:"Current Debt 当前欠款"}),e.jsxs("p",{className:`text-xl font-bold ${t.currentDebt>0?"text-red-600":"text-emerald-600"}`,children:["₱",t.currentDebt.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(t.id,"charge"),className:"p-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",title:"Charge 记账",children:e.jsx(E,{size:20})}),e.jsx("button",{onClick:()=>v(t.id,"settle"),className:"p-2 bg-emerald-50 text-emerald-600 rounded-lg hover:bg-emerald-100 transition-colors",title:"Settle 还款",children:e.jsx(w,{size:20})})]})]})]},t.id))})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:d?"Edit Account 编辑账户":"New Account 新增账户"}),e.jsx("button",{onClick:()=>x(!1),className:"text-slate-400 hover:text-slate-600",children:e.jsx(F,{size:24})})]}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Name 单位/个人名称"}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:t=>a(s=>({...s,name:t.target.value})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"e.g. Construction Corp"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Type 合作方式"}),e.jsxs("select",{value:r.cooperationMethod,onChange:t=>a(s=>({...s,cooperationMethod:t.target.value})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white",children:[e.jsx("option",{value:"协议单位",children:"Agreement 协议单位"}),e.jsx("option",{value:"长期合作",children:"Long-term 长期合作"}),e.jsx("option",{value:"熟客挂帐",children:"VIP 熟客挂帐"}),e.jsx("option",{value:"临时挂帐",children:"Temp 临时挂帐"}),e.jsx("option",{value:"员工签单",children:"Staff 员工签单"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Settlement 结算方式"}),e.jsxs("select",{value:r.settlementMethod,onChange:t=>a(s=>({...s,settlementMethod:t.target.value})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white",children:[e.jsx("option",{value:"月结",children:"Monthly 月结"}),e.jsx("option",{value:"季结",children:"Quarterly 季结"}),e.jsx("option",{value:"单笔结",children:"Per Bill 单笔结"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Approver 批准人"}),e.jsx("input",{type:"text",required:!0,value:r.approver,onChange:t=>a(s=>({...s,approver:t.target.value})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone 电话"}),e.jsx("input",{type:"text",required:!0,value:r.phoneNumber,onChange:t=>a(s=>({...s,phoneNumber:t.target.value})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Initial Debt 初始欠款"}),e.jsx("input",{type:"number",min:"0",disabled:!!d,value:r.currentDebt,onChange:t=>a(s=>({...s,currentDebt:Number(t.target.value)})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-slate-100 disabled:text-slate-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Credit Limit 额度 (Optional)"}),e.jsx("input",{type:"number",min:"0",value:r.creditLimit,onChange:t=>a(s=>({...s,creditLimit:Number(t.target.value)})),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[d&&e.jsx("button",{type:"button",onClick:()=>{M(d.id),x(!1)},className:"px-4 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors mr-auto",children:"Delete 删除"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel 取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium shadow-lg shadow-indigo-200",children:"Save 保存"})]})]})]})}),n.isOpen&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:n.type==="charge"?"Add Charge 记账":"Settle Payment 结算还款"}),e.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Enter amount below"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-xl font-bold text-slate-400",children:"₱"}),e.jsx("input",{type:"number",min:"0",autoFocus:!0,value:g,onChange:t=>f(t.target.value),className:"w-full pl-10 pr-4 py-3 text-2xl font-bold border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 text-center",placeholder:"0.00"})]}),n.type==="settle"&&e.jsxs("div",{className:"mb-6 text-left",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Method 方式"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>i("CASH"),className:`px-2 py-2 text-xs rounded border ${c==="CASH"?"bg-green-50 border-green-500 text-green-700":"bg-white border-slate-200"}`,children:"现金 Cash"}),e.jsx("button",{onClick:()=>i("USDT"),className:`px-2 py-2 text-xs rounded border ${c==="USDT"?"bg-teal-50 border-teal-500 text-teal-700":"bg-white border-slate-200"}`,children:"USDT"}),e.jsx("button",{onClick:()=>i("ALIPAY"),className:`px-2 py-2 text-xs rounded border ${c==="ALIPAY"?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-slate-200"}`,children:"支付宝 Alipay"}),e.jsx("button",{onClick:()=>i("WECHAT"),className:`px-2 py-2 text-xs rounded border ${c==="WECHAT"?"bg-emerald-50 border-emerald-500 text-emerald-700":"bg-white border-slate-200"}`,children:"微信 WeChat"}),e.jsx("button",{onClick:()=>i("GCASH"),className:`px-2 py-2 text-xs rounded border ${c==="GCASH"?"bg-blue-500 border-blue-600 text-white":"bg-white border-slate-200"}`,children:"GCash"}),e.jsx("button",{onClick:()=>i("MAYA"),className:`px-2 py-2 text-xs rounded border ${c==="MAYA"?"bg-green-500 border-green-600 text-white":"bg-white border-slate-200"}`,children:"Maya"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>b({...n,isOpen:!1}),className:"flex-1 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel 取消"}),e.jsx("button",{onClick:L,className:`flex-1 py-2 text-white rounded-lg transition-colors font-medium shadow-lg ${n.type==="charge"?"bg-red-600 hover:bg-red-700 shadow-red-200":"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-200"}`,children:"Confirm 确认"})]})]})})]})};export{G as default};
