import{j as e,O as z}from"./index-BV8Zipq2.js";import{r as i}from"./react-vendor-C14am9Lm.js";import{j as f,X as g,U as E,d as F,R as $,l as U}from"./lucide-CwzgdtcU.js";import"./aws-sdk-BT5ufFbJ.js";import"./recharts-wRm9IGXD.js";const A=({rooms:j,setRooms:u,dishes:N,onPlaceOrder:v})=>{const[o,m]=i.useState(2),[a,b]=i.useState(null),[w,c]=i.useState(!1),[n,x]=i.useState([]),y=j.filter(s=>s.floor===o),O=s=>{b(s),x([]),c(!0)},C=()=>{if(!a)return;const s=a.status==="Vacant"?"Occupied":"Vacant",t=s==="Vacant"?void 0:a.guestName||"临时客人",r=s==="Vacant"?[]:a.orders,l=d=>d.id===a.id?{...d,status:s,guestName:t,orders:r}:d;u(d=>d.map(l)),b(d=>d?{...d,status:s,guestName:t,orders:r}:null)},S=s=>{x(t=>t.find(l=>l.dishId===s.id)?t.map(l=>l.dishId===s.id?{...l,quantity:l.quantity+1}:l):[...t,{dishId:s.id,dishName:s.name,quantity:1,price:s.price}])},k=s=>{x(t=>t.filter(r=>r.dishId!==s))},q=()=>{if(!a||n.length===0)return;const s={id:`ORD-${Date.now()}`,tableNumber:a.number,source:"ROOM_SERVICE",items:n,status:z.PENDING,totalAmount:n.reduce((r,l)=>r+l.price*l.quantity,0),createdAt:new Date().toISOString(),notes:"客房点餐 Room Service"};v(s);const t=r=>{if(r.id===a.id){const l=[...r.orders];return n.forEach(d=>{const p=l.find(R=>R.dishId===d.dishId);p?p.quantity+=d.quantity:l.push(d)}),{...r,status:"Occupied",orders:l,guestName:r.guestName||"点餐客人 Guest"}}return r};u(r=>r.map(t)),alert(`订单已发送至厨房！Order Sent!
房号: ${a.number}`),c(!1)},h=n.reduce((s,t)=>s+t.price*t.quantity,0),I=(a==null?void 0:a.orders.reduce((s,t)=>s+t.price*t.quantity,0))||0;return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(f,{className:"text-orange-500"})," 客房餐饮服务"]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"为客房下单，订单将自动流转至后厨"})]}),e.jsxs("div",{className:"flex bg-white rounded-lg p-1 border border-slate-200 shadow-sm",children:[e.jsx("button",{onClick:()=>m(2),className:`px-6 py-2 rounded-md text-sm font-bold transition-all ${o===2?"bg-orange-500 text-white shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:"2楼 / 2F (82xx)"}),e.jsx("button",{onClick:()=>m(3),className:`px-6 py-2 rounded-md text-sm font-bold transition-all ${o===3?"bg-orange-500 text-white shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:"3楼 / 3F (83xx)"})]})]}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-3",children:y.map(s=>{const t=s.orders.length>0;return e.jsxs("button",{onClick:()=>O(s),className:`
                relative aspect-square flex flex-col items-center justify-center rounded-xl border-2 transition-all p-2
                ${t?"bg-orange-50 border-orange-500 text-orange-900 shadow-md":s.status==="Occupied"?"bg-blue-50 border-blue-300 text-blue-900":"bg-white border-slate-200 text-slate-400 hover:border-orange-300"}
              `,children:[e.jsx("span",{className:"text-lg font-bold",children:s.number}),t&&e.jsxs("div",{className:"mt-1 flex items-center gap-1 text-xs font-bold bg-white/50 px-2 py-0.5 rounded-full",children:[e.jsx(f,{size:10}),e.jsxs("span",{children:["₱",s.orders.reduce((r,l)=>r+l.price*l.quantity,0)]})]}),s.status==="Occupied"&&!t&&e.jsx("span",{className:"text-[10px] mt-1 text-blue-500",children:"In Use"})]},s.id)})}),w&&a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[e.jsx("div",{children:e.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:["Room ",a.number,e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${a.status==="Occupied"?"bg-blue-100 text-blue-700 border-blue-200":"bg-slate-100 text-slate-500 border-slate-200"}`,children:a.status==="Occupied"?"Occupied":"Vacant"})]})}),e.jsx("button",{onClick:()=>c(!1),className:"p-2 text-slate-400 hover:text-slate-600",children:e.jsx(g,{size:24})})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden flex-col md:flex-row",children:[e.jsxs("div",{className:"w-full md:w-1/3 bg-white border-r border-slate-100 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-slate-100",children:e.jsxs("button",{onClick:C,className:`w-full py-2 rounded-lg text-sm font-bold border flex items-center justify-center gap-2 transition-colors ${a.status==="Occupied"?"bg-white border-slate-300 text-slate-600 hover:bg-slate-50":"bg-blue-50 border-blue-200 text-blue-600 hover:bg-blue-100"}`,children:[e.jsx(E,{size:16}),a.status==="Occupied"?"Check Out / Empty":"Check In / Occupy"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 bg-orange-50/30",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-800 mb-3 flex items-center gap-2",children:[e.jsx(F,{size:16})," New Order (待提交)"]}),n.length===0?e.jsx("div",{className:"text-center py-4 text-slate-400 text-xs border border-dashed border-slate-300 rounded-lg",children:"Select items from menu"}):e.jsx("div",{className:"space-y-2",children:n.map((s,t)=>e.jsxs("div",{className:"flex justify-between items-center text-sm bg-white p-2 rounded shadow-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-800 font-medium",children:s.dishName}),e.jsxs("div",{className:"text-xs text-orange-600",children:["₱",s.price," x ",s.quantity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-bold",children:["₱",s.price*s.quantity]}),e.jsx("button",{onClick:()=>k(s.dishId),className:"text-slate-400 hover:text-red-500",children:e.jsx(g,{size:14})})]})]},t))})]}),e.jsx("div",{className:"p-4 border-t border-slate-100 bg-slate-50",children:e.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-2 flex justify-between",children:[e.jsx("span",{children:"Total Unpaid Bill"}),e.jsxs("span",{children:["₱",I]})]})}),e.jsxs("div",{className:"p-4 bg-white border-t border-slate-100 shadow-[0_-4px_10px_rgba(0,0,0,0.05)] z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Cart Total"}),e.jsxs("span",{className:"text-2xl font-bold text-orange-600",children:["₱",h]})]}),e.jsxs("button",{onClick:q,disabled:h===0,className:"w-full py-3 bg-orange-600 text-white rounded-xl font-bold hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-orange-200 flex items-center justify-center gap-2",children:[e.jsx($,{size:18})," Send to Kitchen"]})]})]}),e.jsxs("div",{className:"flex-1 bg-white p-4 overflow-y-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h4",{className:"font-bold text-slate-800",children:"Menu 菜单"})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:N.map(s=>e.jsxs("button",{onClick:()=>S(s),className:"bg-white p-3 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-orange-400 transition-all text-left group flex flex-col h-full",children:[e.jsxs("div",{className:"aspect-video bg-slate-100 rounded-lg overflow-hidden mb-2 relative shrink-0",children:[e.jsx("img",{src:s.imageUrl,className:"w-full h-full object-cover",alt:s.name}),e.jsx("div",{className:"absolute inset-0 bg-black/10 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(U,{className:"text-white drop-shadow-md",size:24})})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm line-clamp-1",children:s.name}),e.jsxs("div",{className:"text-orange-600 font-bold text-sm mt-1",children:["₱",s.price]})]})]},s.id))})]})]})]})})]})};export{A as default};
