import{jsxs as r,jsx as e}from"react/jsx-runtime";import{useMemo as m}from"react";import{ResponsiveContainer as $,PieChart as j,Pie as L,Cell as C,Tooltip as T,Legend as U}from"recharts";import{DollarSign as z,Utensils as K,Mic2 as N,FileSignature as A,BedDouble as F,TrendingUp as I}from"lucide-react";import{O as M}from"./index-CHj5k0ei.js";import"react-dom/client";const h=({title:o,value:d,icon:c,color:a,subValue:l,footer:i})=>r("div",{className:"card-hover flex flex-col justify-between rounded-xl border border-slate-100 bg-white p-6 shadow-sm transition-shadow hover:shadow-md",children:[r("div",{children:[r("div",{className:"mb-2 flex items-start justify-between",children:[r("div",{children:[e("p",{className:"text-sm font-medium text-slate-500",children:o}),e("h3",{className:"mt-1 text-2xl font-bold text-slate-800",children:d})]}),e("div",{className:`rounded-lg p-3 ${a} transition-smooth`,children:e(c,{size:20,className:"text-white"})})]}),l&&r("div",{className:"flex items-center text-sm",children:[r("span",{className:"flex items-center gap-1 font-medium text-green-500",children:[e(I,{size:14})," ",l]}),e("span",{className:"ml-2 text-slate-400",children:"较昨日"})]})]}),i&&e("div",{className:"mt-4 border-t border-slate-50 pt-4 text-xs text-slate-500",children:i})]}),H=({orders:o,ktvRooms:d,signBillAccounts:c,hotelRooms:a=[]})=>{const l=m(()=>o.filter(t=>t.status!==M.CANCELLED).reduce((t,s)=>t+s.totalAmount,0),[o]),i=m(()=>d.reduce((t,s)=>{if(s.status==="InUse"&&s.currentSession){const n=new Date(s.currentSession.startTime).getTime(),p=new Date().getTime(),y=Math.max(1,Math.ceil((p-n)/(1e3*60*60)))*s.hourlyRate,S=s.currentSession.orders?s.currentSession.orders.reduce((D,v)=>D+v.price*v.quantity,0):0;return t+y+S}return t},0),[d]),u=m(()=>a.reduce((t,s)=>{const n=s.orders?s.orders.reduce((p,x)=>p+x.price*x.quantity,0):0;return t+n},0),[a]),g=m(()=>c.reduce((t,s)=>t+(s?.currentDebt||0),0),[c]),b=a.filter(t=>t.orders&&t.orders.length>0).length,w=l+i+u+g,f=[{name:"餐厅堂食",value:l,color:"#ef4444"},{name:"KTV营收",value:i+l*.2,color:"#8b5cf6"},{name:"客房点餐",value:u,color:"#f97316"},{name:"挂账待收",value:g,color:"#f59e0b"}];return r("div",{className:"fade-in space-y-6",children:[r("div",{className:"slide-in-left mb-6 flex items-center justify-between",children:[r("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"运营总览"}),e("p",{className:"text-sm text-slate-500",children:"江西酒店 (Pasay City) - 实时经营数据"})]}),e("div",{className:"transition-smooth rounded-lg border border-slate-200 bg-white px-3 py-1 text-sm font-medium text-slate-600 shadow-sm",children:new Date().toLocaleDateString("zh-CN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),r("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e("div",{className:"slide-in-left",children:e(h,{title:"餐饮总营收",value:`₱${l.toLocaleString()}`,icon:z,color:"bg-emerald-500",footer:"包含堂食与外卖"})}),e("div",{className:"slide-in-left delay-75",children:e(h,{title:"客房点餐",value:`₱${u.toLocaleString()}`,icon:K,color:"bg-orange-500",footer:`${b} 个房间正在用餐`})}),e("div",{className:"slide-in-right delay-100",children:e(h,{title:"KTV 实时营收",value:`₱${i.toLocaleString()}`,icon:N,color:"bg-purple-500",footer:"正在使用包厢预计收入"})}),e("div",{className:"slide-in-right delay-150",children:e(h,{title:"应收挂账款",value:`₱${g.toLocaleString()}`,icon:A,color:"bg-yellow-500",footer:`${c.filter(t=>t.currentDebt>0).length} 个单位欠款`})})]}),r("div",{className:"fade-in mt-6 grid grid-cols-1 gap-6 delay-200 lg:grid-cols-3",children:[r("div",{className:"card-hover rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[e("h3",{className:"mb-2 text-lg font-bold text-slate-800",children:"收入构成分析"}),r("div",{className:"relative h-64 min-h-[256px]",children:[e($,{width:"100%",height:"100%",minWidth:0,children:r(j,{children:[e(L,{data:f,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:f.map((t,s)=>e(C,{fill:t.color},`cell-${s}`))}),e(T,{formatter:t=>`₱${t.toLocaleString()}`}),e(U,{verticalAlign:"bottom"})]})}),e("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:r("div",{className:"mt-[-40px] text-center",children:[e("p",{className:"text-xs text-slate-400",children:"今日总营收"}),r("p",{className:"text-xl font-bold text-slate-800",children:["₱",w.toLocaleString()]})]})})]})]}),r("div",{className:"space-y-6 lg:col-span-2",children:[r("div",{className:"card-hover rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[e("div",{className:"mb-4 flex items-center justify-between",children:r("h3",{className:"flex items-center gap-2 font-bold text-slate-800",children:[e(F,{size:18})," 客房用餐监控"]})}),b===0?e("div",{className:"py-4 text-sm text-slate-400",children:"当前无客房点餐 No Active Orders"}):e("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:a.filter(t=>t.orders&&t.orders.length>0).map(t=>r("div",{className:"transition-smooth transform-scale-hover flex items-center justify-between rounded-lg border border-orange-200 bg-orange-50 p-3",children:[e("span",{className:"font-bold text-orange-800",children:t.number}),r("span",{className:"rounded bg-white px-2 py-1 text-xs font-bold text-orange-600",children:["₱",t.orders?t.orders.reduce((s,n)=>s+n.price*n.quantity,0):0]})]},t.id))})]}),r("div",{className:"card-hover rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[e("div",{className:"mb-4 flex items-center justify-between",children:r("h3",{className:"flex items-center gap-2 font-bold text-slate-800",children:[e(N,{size:18})," KTV 包厢状态 (4F)"]})}),e("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:d.map(t=>r("div",{className:`flex items-center justify-between rounded-lg border p-3 ${t.status==="InUse"?"border-purple-200 bg-purple-50":"border-slate-100 bg-slate-50"}`,children:[e("span",{className:`font-bold ${t.status==="InUse"?"text-purple-700":"text-slate-500"}`,children:t.name}),e("span",{className:`h-2 w-2 rounded-full ${t.status==="InUse"?"animate-pulse bg-purple-500":"bg-slate-300"}`})]},t.id))})]})]})]})]})};export{H as default};
