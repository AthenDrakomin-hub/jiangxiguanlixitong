import{jsx as e,jsxs as a,Fragment as ve}from"react/jsx-runtime";import{useState as m,useEffect as V,useMemo as v}from"react";import{X as Y,MapPin as Q,Clock as Re,Printer as Me,Utensils as Le,Rocket as qe,Mic2 as Fe,BedDouble as Ue,CreditCard as ye,ClipboardList as He,Wallet as J,CircleDollarSign as Ke,Smartphone as De,QrCode as X,Banknote as Z,Receipt as we,Loader2 as Be,Wifi as We,Phone as Ge,Send as Ve,Search as Ye,UtensilsCrossed as Qe,Minus as Ce,Plus as G,History as Je,Eye as Xe,ShoppingBag as _e,ChevronRight as z,Home as Ze,ArrowLeft as et}from"lucide-react";import{t as s,O as p,a as tt,L as $e,s as ke}from"./index-Bha_CnxB.js";import{I as Ee}from"./ImageLazyLoad-DPO3Dik5.js";import{a as at}from"./auditLogger-DYWE_lBP.js";import"react-dom/client";function st(i,u){const[f,d]=m(i);return V(()=>{const o=setTimeout(()=>{d(i)},u);return()=>{clearTimeout(o)}},[i,u]),f}const lt=(i,u,f=30)=>{const d=new Date;d.setTime(d.getTime()+f*24*60*60*1e3),document.cookie=`${i}=${u};expires=${d.toUTCString()};path=/`},rt=i=>{const u=`${i}=`,f=document.cookie.split(";");for(let d=0;d<f.length;d++){let o=f[d];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(u)===0)return o.substring(u.length,o.length)}return null},nt=({order:i,onClose:u,onPrint:f})=>{const d=h=>{switch(h){case p.PENDING:return a("span",{className:"inline-flex flex-col items-center rounded-full bg-orange-100 px-2.5 py-0.5 text-xs font-medium text-orange-800",children:[e("span",{children:s("pending_status")}),e("span",{className:"text-[10px] opacity-75",children:"Pending"})]});case p.COOKING:return a("span",{className:"inline-flex flex-col items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800",children:[e("span",{children:s("cooking_status")}),e("span",{className:"text-[10px] opacity-75",children:"Cooking"})]});case p.SERVED:return a("span",{className:"inline-flex flex-col items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800",children:[e("span",{children:s("served_status")}),e("span",{className:"text-[10px] opacity-75",children:"Served"})]});case p.PAID:return a("span",{className:"inline-flex flex-col items-center rounded-full bg-emerald-100 px-2.5 py-0.5 text-xs font-medium text-emerald-800",children:[e("span",{children:s("paid_status")}),e("span",{className:"text-[10px] opacity-75",children:"Paid"})]});case p.COMPLETED:return a("span",{className:"inline-flex flex-col items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-800",children:[e("span",{children:"已完成"}),e("span",{className:"text-[10px] opacity-75",children:"Completed"})]});case p.CANCELLED:return a("span",{className:"inline-flex flex-col items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800",children:[e("span",{children:"已取消"}),e("span",{className:"text-[10px] opacity-75",children:"Cancelled"})]});default:return e("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-800",children:h})}},o=h=>{switch(h){case"CASH":return e(Z,{className:"h-4 w-4"});case"WECHAT":return e(X,{className:"h-4 w-4"});case"ALIPAY":return e(De,{className:"h-4 w-4"});case"USDT":return e(Ke,{className:"h-4 w-4"});case"GCASH":case"MAYA":return e(J,{className:"h-4 w-4"});case"CREDIT_CARD":case"UNIONPAY":return e(ye,{className:"h-4 w-4"});case"SIGN_BILL":return e(He,{className:"h-4 w-4"});default:return e(ye,{className:"h-4 w-4"})}},C=h=>{switch(h){case"ROOM_SERVICE":return a("span",{className:"flex items-center gap-1 rounded bg-orange-100 px-2 py-0.5 text-xs font-medium text-orange-700",children:[e(Ue,{size:12})," 客房 Room"]});case"KTV":return a("span",{className:"flex items-center gap-1 rounded bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-700",children:[e(Fe,{size:12})," KTV"]});case"TAKEOUT":return a("span",{className:"flex items-center gap-1 rounded bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:[e(qe,{size:12})," 外卖 Takeout"]});default:return a("span",{className:"flex items-center gap-1 rounded bg-slate-100 px-2 py-0.5 text-xs font-medium text-slate-700",children:[e(Le,{size:12})," 堂食 Dine-in"]})}},k=h=>new Date(h).toLocaleString();return e("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:a("div",{className:"flex max-h-[90vh] w-full max-w-md flex-col overflow-hidden rounded-lg bg-white shadow-xl",children:[a("div",{className:"flex items-center justify-between border-b border-slate-200 bg-slate-50 p-4",children:[e("h3",{className:"text-lg font-semibold text-slate-900",children:s("order_detail_title")}),e("button",{onClick:u,className:"text-slate-400 hover:text-slate-600 focus:outline-none",children:e(Y,{className:"h-6 w-6"})})]}),a("div",{className:"flex-1 space-y-4 overflow-y-auto p-4",children:[a("div",{className:"rounded-lg bg-slate-50 p-4",children:[a("div",{className:"flex items-start justify-between",children:[a("div",{children:[a("h4",{className:"font-medium text-slate-900",children:["#",i.id]}),a("div",{className:"mt-1 flex items-center gap-2 text-sm text-slate-500",children:[e(Q,{className:"h-4 w-4"}),a("span",{children:["Table ",i.tableNumber]})]}),e("div",{className:"mt-1",children:C(i.source)})]}),d(i.status)]}),a("div",{className:"mt-2 flex items-center text-sm text-slate-500",children:[e(Re,{className:"mr-1 h-4 w-4"}),e("span",{children:k(i.createdAt)})]}),i.paymentMethod&&a("div",{className:"mt-2 flex items-center text-sm text-slate-700",children:[o(i.paymentMethod),e("span",{className:"ml-1 font-medium",children:i.paymentMethod})]})]}),a("div",{children:[e("h4",{className:"mb-2 font-medium text-slate-900",children:s("order_items")}),e("div",{className:"space-y-2",children:i.items.map((h,b)=>a("div",{className:"flex items-center justify-between border-b border-slate-100 py-2",children:[a("div",{children:[e("p",{className:"font-medium text-slate-900",children:h.dishName}),a("p",{className:"text-sm text-slate-500",children:["x",h.quantity]})]}),a("p",{className:"font-medium text-slate-900",children:["₱",h.price*h.quantity]})]},b))})]}),i.notes&&a("div",{children:[e("h4",{className:"mb-2 font-medium text-slate-900",children:s("special_requests")}),e("p",{className:"rounded-lg bg-yellow-50 p-3 text-slate-700 border border-yellow-100",children:i.notes})]}),e("div",{className:"border-t border-slate-200 pt-4",children:a("div",{className:"flex justify-between",children:[e("p",{className:"text-slate-600",children:s("total_amount")}),a("p",{className:"font-bold text-slate-900",children:["₱",i.totalAmount]})]})})]}),a("div",{className:"flex gap-2 border-t border-slate-200 p-4",children:[e("button",{onClick:u,className:"flex-1 rounded-lg bg-slate-200 px-4 py-2 font-medium text-slate-800 hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2",children:s("close")}),f&&a("button",{onClick:f,className:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-slate-900 px-4 py-2 font-medium text-white hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2",children:[e(Me,{size:16}),s("print_receipt")]})]})]})})},ut=({dishes:i=[],orders:u=[],onPlaceOrder:f,systemSettings:d})=>{const[o,C]=m("MENU"),[k,h]=m("All"),[b,M]=m([]),[ee,L]=m(!1),[te,ae]=m(""),A=st(te,300),[se,le]=m(""),[q,F]=m(!1),[E,y]=m(null),[_,j]=m(""),[O,re]=m(!1),[D,ne]=m(""),[ie,oe]=m("zh-CN"),P=t=>t.name_en&&ie!=="zh-CN"?`${t.name} / ${t.name_en}`:t.name,[U,de]=m(null),ze=t=>{const l=window.open("","_blank");if(!l)return;const r=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>${s("print_receipt")}</title>
        <style>
          body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            font-size: 12px;
          }
          .receipt-header {
            text-align: center;
            border-bottom: 1px dashed #000;
            padding-bottom: 10px;
            margin-bottom: 10px;
          }
          .receipt-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .order-info {
            margin-bottom: 10px;
          }
          .order-info div {
            margin-bottom: 3px;
          }
          .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
          }
          .items-table th,
          .items-table td {
            text-align: left;
            padding: 3px 0;
            border-bottom: 1px dashed #000;
          }
          .items-table th {
            font-weight: bold;
          }
          .total-section {
            border-top: 1px dashed #000;
            padding-top: 5px;
            font-weight: bold;
          }
          .text-center { text-align: center; }
          .text-right { text-align: right; }
          .mb-1 { margin-bottom: 5px; }
          .mt-1 { margin-top: 5px; }
        </style>
      </head>
      <body>
        <div class="receipt-header">
          <div class="receipt-title">${xe}</div>
          <div>${s("order_detail_title")}</div>
        </div>
        
        <div class="order-info">
          <div><strong>${s("order_id")}:</strong> ${t.id}</div>
          <div><strong>${s("table_number")}:</strong> ${t.tableNumber}</div>
          <div><strong>${s("order_time")}:</strong> ${new Date(t.createdAt).toLocaleString()}</div>
          <div><strong>${s("status")}:</strong> ${t.status}</div>
          ${t.paymentMethod?`<div><strong>${s("payment_method")}:</strong> ${t.paymentMethod}</div>`:""}
        </div>
        
        <table class="items-table">
          <thead>
            <tr>
              <th>${s("item")}</th>
              <th class="text-right">${s("quantity")}</th>
              <th class="text-right">${s("price")}</th>
              <th class="text-right">${s("amount")}</th>
            </tr>
          </thead>
          <tbody>
            ${t.items.map(n=>`
              <tr>
                <td>${n.dishName}</td>
                <td class="text-right">${n.quantity}</td>
                <td class="text-right">₱${n.price.toFixed(2)}</td>
                <td class="text-right">₱${(n.price*n.quantity).toFixed(2)}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
        
        ${t.notes?`
          <div class="mb-1">
            <strong>${s("special_requests")}:</strong>
            <div>${t.notes}</div>
          </div>
        `:""}
        
        <div class="total-section">
          <div class="text-right">
            <strong>${s("total_amount")}: ₱${t.totalAmount.toFixed(2)}</strong>
          </div>
        </div>
        
        <div class="text-center mt-1">
          ${s("thank_you_message")}
        </div>
      </body>
      </html>
    `;l.document.open(),l.document.write(r),l.document.close(),l.onload=()=>{l.focus(),l.print()}},[Se,Ae]=m("加载中..."),[ce,me]=m(null),[he,I]=m(null),c=d?.storeInfo,xe=c?.name||s("default_store_name"),ue=d?.exchangeRate||8.2,H=d?.serviceChargeRate||.1,x=v(()=>d?.h5PageSettings||{enableCustomStyling:!0,customHeaderColor:"#4F46E5",customButtonColor:"#DC2626",showStoreInfo:!0,showWiFiInfo:!0},[d?.h5PageSettings]),je=["All",...d?.categories||[]],T=d?.payment||{aliPayEnabled:!1,weChatEnabled:!1,gCashEnabled:!0,mayaEnabled:!0};V(()=>{let t=null;return x?.enableCustomStyling&&(t=document.createElement("style"),t.id="customer-order-custom-styles",t.innerHTML=`
        .custom-header {
          background-color: ${x.customHeaderColor} !important;
        }
        .custom-button {
          background-color: ${x.customButtonColor} !important;
        }
      `,document.head.appendChild(t)),()=>{t&&document.head.contains(t)&&document.head.removeChild(t)}},[x]),V(()=>{const t=new URLSearchParams(window.location.search),l=t.get("id"),r=t.get("lang"),n=rt($e);let w="zh-CN";r==="fil"||r==="zh-CN"?w=r:(n==="fil"||n==="zh-CN")&&(w=n),oe(w),ke(w),ne(l||"LOBBY")},[]);const be=v(()=>i.filter(t=>{const l=k==="All"||t.category===k,r=t.name.toLowerCase().includes(A.toLowerCase())||t.name_en&&t.name_en.toLowerCase().includes(A.toLowerCase())||t.description.toLowerCase().includes(A.toLowerCase());return l&&r}),[i,k,A]),K=(t,l)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),R(l))},pe=(t,l)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),W(l))},fe=(t,l)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),C(l))},Oe=v(()=>b.reduce((t,l)=>t+l.quantity,0),[b]),S=v(()=>b.reduce((t,l)=>t+l.dish.price*l.quantity,0),[b]),B=v(()=>S*H,[S,H]),g=v(()=>S+B,[S,B]),N=v(()=>u.filter(t=>t.tableNumber===D).sort((t,l)=>new Date(l.createdAt).getTime()-new Date(t.createdAt).getTime()),[u,D]),ge=v(()=>{if(N.length===0||i.length===0)return[];const t={};return N.forEach(r=>{r.items.forEach(n=>{t[n.dishId]=(t[n.dishId]||0)+n.quantity})}),Object.entries(t).sort((r,n)=>n[1]-r[1]).slice(0,5).map(([r])=>i.find(n=>n.id===r)).filter(Boolean)},[N,i]),$=v(()=>{if(N.length===0)return null;const t=new Date;t.setHours(0,0,0,0);const l=new Date(t);l.setDate(l.getDate()-1);const r={today:{orders:0,revenue:0},yesterday:{orders:0,revenue:0},total:{orders:N.length,revenue:0}};return N.forEach(n=>{const w=new Date(n.createdAt);w.setHours(0,0,0,0),r.total.revenue+=n.totalAmount,w.getTime()===t.getTime()&&(r.today.orders+=1,r.today.revenue+=n.totalAmount),w.getTime()===l.getTime()&&(r.yesterday.orders+=1,r.yesterday.revenue+=n.totalAmount)}),r},[N]),R=t=>{M(l=>l.find(n=>n.dish.id===t.id)?l.map(n=>n.dish.id===t.id?{...n,quantity:n.quantity+1}:n):[...l,{dish:t,quantity:1}])},W=t=>{M(l=>{const r=l.find(n=>n.dish.id===t);return r&&r.quantity>1?l.map(n=>n.dish.id===t?{...n,quantity:n.quantity-1}:n):l.filter(n=>n.dish.id!==t)})},Pe=()=>{b.length!==0&&(L(!1),F(!0))},Ne=async()=>{if(E){re(!0),Ae(s("processing_payment")),me(null);try{const t={id:`ORD-${Date.now()}`,tableNumber:D,source:/^8[23]\d{2}$/.test(D)?"ROOM_SERVICE":"LOBBY",items:b.map(r=>({dishId:r.dish.id,dishName:P(r.dish),quantity:r.quantity,price:r.dish.price})),status:p.PENDING,totalAmount:g,paymentMethod:E,createdAt:new Date().toISOString(),notes:se||""};await tt.create("orders",t),f(t),at.log("info","CUSTOMER_ORDER",`H5点餐: ${D} - ${E} - ₱${g.toFixed(2)}`,"customer");try{await fetch("/api/print-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t})}),console.log("[CustomerOrder] 订单已发送到打印队列")}catch(r){console.warn("[CustomerOrder] 打印失败，但订单已成功创建:",r)}const l=window.ReactNativeWebView;typeof window<"u"&&l&&l.postMessage(JSON.stringify({type:"NEW_ORDER",order:t})),M([]),F(!1),y(null),j(""),le(""),I(s("order_placed_successfully")||"订单提交成功！"),setTimeout(()=>I(null),3e3),C("ORDERS")}catch(t){console.error("Failed to process payment:",t),me(s("error")||"订单提交失败，请重试")}finally{re(!1)}}},Ie=()=>{const t=ie==="zh-CN"?"fil":"zh-CN";oe(t),ke(t),lt($e,t,30)},Te=t=>{switch(t){case p.PENDING:return e("span",{className:"rounded bg-orange-100 px-2 py-0.5 text-xs font-bold text-orange-600",children:s("pending_status")});case p.COOKING:return e("span",{className:"rounded bg-blue-100 px-2 py-0.5 text-xs font-bold text-blue-600",children:s("cooking_status")});case p.SERVED:return e("span",{className:"rounded bg-green-100 px-2 py-0.5 text-xs font-bold text-green-600",children:s("served_status")});case p.PAID:return e("span",{className:"rounded bg-green-100 px-2 py-0.5 text-xs font-bold text-green-600",children:s("paid_status")});default:return e("span",{className:"rounded bg-slate-100 px-2 py-0.5 text-xs font-bold text-slate-600",children:"Unknown"})}};return a("div",{className:"fade-in relative mx-auto min-h-screen max-w-md overflow-hidden bg-slate-50 pb-24 font-sans shadow-2xl",children:[ce&&e("div",{className:"fixed left-1/2 top-4 z-50 -translate-x-1/2 transform rounded-lg border border-red-200 bg-red-50 px-6 py-3 text-red-700 shadow-lg",children:a("div",{className:"flex items-center gap-2",children:[e(Y,{size:18}),e("span",{className:"font-medium",children:ce})]})}),he&&e("div",{className:"fixed left-1/2 top-4 z-50 -translate-x-1/2 transform rounded-lg border border-green-200 bg-green-50 px-6 py-3 text-green-700 shadow-lg",children:a("div",{className:"flex items-center gap-2",children:[e(we,{size:18}),e("span",{className:"font-medium",children:he})]})}),O&&e("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",children:a("div",{className:"flex flex-col items-center gap-3 rounded-xl bg-white p-6 shadow-2xl",children:[e(Be,{className:"animate-spin text-red-600",size:32}),e("p",{className:"font-medium text-slate-700",children:Se})]})}),a("button",{onClick:Ie,className:"absolute right-4 top-4 z-30 flex items-center gap-1 rounded-full border border-slate-300 bg-white/80 px-3 py-1 text-xs font-bold text-slate-700 shadow-sm backdrop-blur-sm",children:[s("language_toggle")," "]}),o==="MENU"&&a("div",{className:`relative shrink-0 pb-6 ${x?.enableCustomStyling?"custom-header":"bg-slate-800"}`,children:[e("div",{className:"absolute inset-0 overflow-hidden opacity-60",children:e(Ee,{src:c?.bannerImageUrl||"https://picsum.photos/800/400?random=restaurant",alt:"Restaurant Banner",className:"h-full w-full object-cover"})}),e("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent"}),a("div",{className:"relative z-10 p-5 pt-8 text-white",children:[e("h1",{className:"mb-3 text-xl font-bold leading-tight shadow-sm",children:xe}),x?.showStoreInfo&&a("div",{className:"space-y-1.5 text-xs opacity-90",children:[a("div",{className:"flex items-start gap-2",children:[e(Q,{size:14,className:"mt-0.5 shrink-0 text-red-400"}),e("span",{children:c?.address}),c?.mapUrl&&e("a",{href:c.mapUrl,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-500 hover:text-blue-700",children:"[地图]"})]}),x?.showWiFiInfo&&c?.wifiSsid&&a("div",{className:"flex items-center gap-4",children:[a("div",{className:"flex items-center gap-2",children:[e(We,{size:14,className:"text-blue-400"}),a("span",{children:["WiFi: ",c.wifiSsid]})]}),c.wifiPassword&&a("span",{children:["Pass: ",c.wifiPassword]}),e("button",{onClick:()=>{const t=`WiFi: ${c.wifiSsid}${c.wifiPassword?`, Pass: ${c.wifiPassword}`:""}`;navigator.clipboard.writeText(t).then(()=>{I("WiFi信息已复制到剪贴板"),setTimeout(()=>I(null),2e3)})},className:"text-xs text-blue-500 hover:text-blue-700",children:"[复制]"})]}),a("div",{className:"flex items-center gap-4",children:[c?.phone&&a("div",{className:"flex items-center gap-2",children:[e(Ge,{size:14,className:"text-green-400"}),e("a",{href:`tel:${c.phone}`,className:"hover:text-green-600",children:c.phone})]}),c?.telegram&&a("div",{className:"flex items-center gap-2",children:[e(Ve,{size:14,className:"text-sky-400"}),e("a",{href:`https://t.me/${c.telegram.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"hover:text-sky-600",children:c.telegram})]})]})]})]}),a("div",{className:"absolute left-4 top-4 z-20 flex items-center gap-1 rounded-full border border-white/30 bg-white/20 px-3 py-1 text-xs font-bold text-white backdrop-blur-md",children:[e(Q,{size:12})," ",D]})]}),a("div",{className:`flex-1 overflow-y-auto ${o==="MENU"?"relative z-10 -mt-4 rounded-t-2xl bg-slate-50":"pt-4"}`,children:[o==="MENU"&&a(ve,{children:[a("div",{className:"slide-in-left sticky top-0 z-20 bg-slate-50 px-4 pb-2 pt-4 shadow-sm",children:[a("div",{className:"relative mb-3",children:[e(Ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),e("input",{type:"text",placeholder:s("search_placeholder"),value:te,onChange:t=>ae(t.target.value),className:"transition-smooth w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-9 pr-4 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500"})]}),ge.length>0&&a("div",{className:"slide-in-left mb-4 delay-75",children:[e("h3",{className:"mb-2 text-sm font-bold text-slate-700",children:s("recommended_for_you")}),e("div",{className:"flex gap-2 overflow-x-auto pb-2",children:ge.map(t=>a("button",{onClick:()=>{h(t.category),ae(t.name)},className:"card-hover flex flex-shrink-0 flex-col items-center gap-1 rounded-lg border border-slate-200 bg-white p-2 shadow-sm",children:[e("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-slate-100",children:e("span",{className:"truncate px-1 text-xs font-bold text-slate-600",children:P(t).substring(0,8)})}),a("span",{className:"w-16 truncate text-xs text-slate-500",children:["₱",t.price]})]},t.id))})]}),e("div",{className:"scrollbar-hide slide-in-left flex gap-2 overflow-x-auto pb-2 delay-100",children:je.map(t=>e("button",{onClick:()=>h(t),className:`btn-primary whitespace-nowrap rounded-full px-4 py-1.5 text-xs font-bold shadow-sm transition-all ${k===t?x?.enableCustomStyling?"custom-button shadow-custom scale-105 text-white":"scale-105 bg-red-600 text-white shadow-red-200":"border border-slate-200 bg-white text-slate-500"}`,children:t==="All"?s("all_categories"):t},t))})]}),e("div",{className:"fade-in min-h-[50vh] space-y-4 p-4 delay-150",children:be.length===0?a("div",{className:"flex flex-col items-center py-10 text-center text-sm text-slate-400",children:[e(Qe,{size:32,className:"mb-2 opacity-50"}),e("span",{children:s("no_items_found")})]}):be.map(t=>{const l=b.find(r=>r.dish.id===t.id)?.quantity||0;return a("div",{className:"card-hover flex gap-3 rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",role:"article","aria-labelledby":`dish-name-${t.id}`,children:[e("div",{className:"h-24 w-24 shrink-0 overflow-hidden rounded-xl bg-slate-100",children:e(Ee,{src:t.imageUrl||"/placeholder-image.jpg",alt:t.name,className:"h-full w-full object-cover"})}),a("div",{className:"flex min-w-0 flex-1 flex-col justify-between py-0.5",children:[a("div",{children:[e("h3",{id:`dish-name-${t.id}`,className:"truncate text-sm font-bold text-slate-800",children:P(t)}),e("p",{className:"mt-0.5 line-clamp-2 text-xs leading-relaxed text-slate-400",children:t.description})]}),a("div",{className:"mt-1 flex items-end justify-between",children:[a("div",{children:[a("div",{className:"text-lg font-bold text-red-600",children:["₱",t.price]}),a("div",{className:"text--[10px] text-slate-400",children:[s("reference_price"),": ¥",(t.price/ue).toFixed(0)]})]}),l>0?a("div",{className:"flex items-center gap-3 rounded-full border border-slate-200 bg-slate-50 px-1 py-1 shadow-inner",role:"group","aria-label":s("quantity_controls"),children:[e("button",{onClick:()=>W(t.id),onKeyDown:r=>K(r,t),className:"btn-primary flex h-7 w-7 items-center justify-center rounded-full border border-slate-100 bg-white text-slate-600 shadow-sm transition-transform active:scale-90","aria-label":`${s("decrease_quantity")} ${t.name}`,children:e(Ce,{size:14})}),e("span",{className:"min-w-[16px] text-center text-sm font-bold text-slate-800","aria-live":"polite",children:l}),e("button",{onClick:()=>R(t),onKeyDown:r=>K(r,t),className:`flex h-7 w-7 items-center justify-center rounded-full text-white shadow-sm transition-transform active:scale-90 ${x?.enableCustomStyling?"custom-button":"bg-red-600"} btn-primary`,"aria-label":`${s("increase_quantity")} ${t.name}`,children:e(G,{size:14})})]}):e("button",{onClick:()=>R(t),onKeyDown:r=>K(r,t),className:`flex h-8 w-8 items-center justify-center rounded-full shadow-sm transition-colors active:scale-90 ${x?.enableCustomStyling?"custom-button text-white hover:text-white":"bg-red-50 text-red-600 hover:bg-red-600 hover:text-white"} btn-primary`,"aria-label":`${s("add_to_cart")} ${t.name}`,children:e(G,{size:18})})]})]})]},t.id)})})]}),o==="ORDERS"&&a("div",{className:"fade-in space-y-4 p-4",children:[e("h2",{className:"slide-in-right mb-4 px-2 text-xl font-bold text-slate-800",children:s("order_history")}),$&&a("div",{className:"slide-in-right mb-4 grid grid-cols-3 gap-2 delay-75",children:[a("div",{className:"card-hover rounded-lg border border-slate-100 bg-white p-3 text-center shadow-sm",children:[e("div",{className:"mb-1 text-xs text-slate-500",children:s("today")}),e("div",{className:"font-bold text-slate-800",children:$.today.orders}),e("div",{className:"text-xs text-slate-500",children:s("orders")})]}),a("div",{className:"card-hover rounded-lg border border-slate-100 bg-white p-3 text-center shadow-sm",children:[e("div",{className:"mb-1 text-xs text-slate-500",children:s("yesterday")}),e("div",{className:"font-bold text-slate-800",children:$.yesterday.orders}),e("div",{className:"text-xs text-slate-500",children:s("orders")})]}),a("div",{className:"card-hover rounded-lg border border-slate-100 bg-white p-3 text-center shadow-sm",children:[e("div",{className:"mb-1 text-xs text-slate-500",children:s("total")}),e("div",{className:"font-bold text-slate-800",children:$.total.orders}),e("div",{className:"text-xs text-slate-500",children:s("orders")})]}),a("div",{className:"card-hover rounded-lg border border-slate-100 bg-white p-3 text-center shadow-sm",children:[e("div",{className:"mb-1 text-xs text-slate-500",children:s("today")}),a("div",{className:"font-bold text-slate-800",children:["₱",$.today.revenue.toFixed(0)]}),e("div",{className:"text-xs text-slate-500",children:s("revenue")})]}),a("div",{className:"card-hover rounded-lg border border-slate-100 bg-white p-3 text-center shadow-sm",children:[e("div",{className:"mb-1 text-xs text-slate-500",children:s("yesterday")}),a("div",{className:"font-bold text-slate-800",children:["₱",$.yesterday.revenue.toFixed(0)]}),e("div",{className:"text-xs text-slate-500",children:s("revenue")})]}),a("div",{className:"card-hover rounded-lg border border-slate-100 bg-white p-3 text-center shadow-sm",children:[e("div",{className:"mb-1 text-xs text-slate-500",children:s("total")}),a("div",{className:"font-bold text-slate-800",children:["₱",$.total.revenue.toFixed(0)]}),e("div",{className:"text-xs text-slate-500",children:s("revenue")})]})]}),N.length===0?a("div",{className:"slide-in-right rounded-2xl border border-dashed border-slate-200 bg-white py-12 text-center text-slate-400 delay-100",children:[e(Je,{size:48,className:"mx-auto mb-3 opacity-30"}),e("p",{children:s("no_orders_yet")}),e("button",{onClick:()=>C("MENU"),className:"btn-primary mt-4 text-sm font-bold text-red-600",children:s("order_now")})]}):N.map(t=>a("div",{className:"card-hover slide-in-right overflow-hidden rounded-2xl border border-slate-100 bg-white shadow-sm delay-150",children:[a("div",{className:"flex items-center justify-between border-b border-slate-50 bg-slate-50/50 p-4",children:[e("span",{className:"font-mono text-xs text-slate-500",children:new Date(t.createdAt).toLocaleString()}),Te(t.status)]}),a("div",{className:"space-y-2 p-4",children:[t.items.map((l,r)=>a("div",{className:"flex justify-between text-sm",children:[a("span",{className:"font-medium text-slate-700",children:["x",l.quantity," ",l.dishName]}),a("span",{className:"text-slate-500",children:["₱",l.price*l.quantity]})]},r)),t.paymentMethod==="CASH"&&t.status===p.PENDING&&e("div",{className:"mt-2 rounded bg-yellow-50 p-2 text-xs text-yellow-800",children:s("cash_collection_notice")}),a("div",{className:"mt-2 flex items-center justify-between border-t border-slate-50 pt-3",children:[e("span",{className:"text-sm font-bold text-slate-600",children:s("total_label")}),a("span",{className:"text-lg font-bold text-slate-800",children:["₱",t.totalAmount]})]})]}),e("div",{className:"border-t border-slate-50 bg-slate-50/50 p-4",children:a("button",{onClick:()=>de(t),className:"btn-primary flex w-full items-center justify-center gap-2 text-sm font-medium text-red-600 hover:text-red-700",children:[e(Xe,{size:16}),s("view_details")]})})]},t.id))]})]}),o==="MENU"&&b.length>0&&!ee&&!q&&e("div",{className:"fixed bottom-24 left-4 right-4 z-30 mx-auto max-w-md",children:a("button",{onClick:()=>L(!0),className:`bounce-soft flex w-full items-center justify-between rounded-2xl border border-white/10 p-4 text-white shadow-2xl backdrop-blur transition-transform active:scale-[0.98] ${x?.enableCustomStyling?"custom-button":"bg-slate-900/95"} btn-primary`,children:[a("div",{className:"flex items-center gap-4",children:[a("div",{className:"relative",children:[e(_e,{size:24}),e("span",{className:"absolute -right-2 -top-2 flex h-5 w-5 items-center justify-center rounded-full border-2 border-slate-900 bg-red-500 text-[10px] font-bold text-white",children:Oe})]}),e("div",{className:"text-left",children:a("div",{className:"text-lg font-bold",children:["₱",g.toFixed(0)]})})]}),a("div",{className:"flex items-center gap-2 text-sm font-bold text-slate-200",children:[s("view_cart")," ",e(z,{size:16})]})]})}),a("div",{className:"fixed bottom-0 left-0 right-0 z-40 mx-auto flex max-w-md justify-around border-t border-slate-200 bg-white p-2",role:"navigation","aria-label":s("bottom_navigation"),children:[a("button",{onClick:()=>C("MENU"),onKeyDown:t=>fe(t,"MENU"),className:`flex w-full flex-col items-center justify-center rounded-xl py-2 transition-colors ${o==="MENU"?"bg-red-50 text-red-600":"text-slate-400"}`,"aria-selected":o==="MENU",role:"tab",children:[e(Ze,{size:24}),e("span",{className:"mt-1 text-[10px] font-bold",children:s("menu_tab")})]}),a("button",{onClick:()=>C("ORDERS"),onKeyDown:t=>fe(t,"ORDERS"),className:`flex w-full flex-col items-center justify-center rounded-xl py-2 transition-colors ${o==="ORDERS"?"bg-red-50 text-red-600":"text-slate-400"}`,"aria-selected":o==="ORDERS",role:"tab",children:[e(we,{size:24}),e("span",{className:"mt-1 text-[10px] font-bold",children:s("orders_tab")}),N.length>0&&o!=="ORDERS"&&e("span",{className:"absolute right-[20%] top-2 h-2 w-2 rounded-full bg-red-500","aria-label":s("unread_orders")})]})]}),ee&&!q&&e("div",{className:"animate-in fade-in fixed inset-0 z-50 flex items-end justify-center bg-black/60 p-0 duration-200 sm:items-center sm:p-4",children:a("div",{className:"animate-in slide-in-from-bottom-10 slide-in-up flex max-h-[85vh] w-full max-w-md flex-col overflow-hidden rounded-t-3xl bg-white duration-300 sm:rounded-3xl",children:[a("div",{className:"flex items-center justify-between border-b border-slate-100 bg-slate-50/80 p-5 backdrop-blur",children:[a("h3",{className:"flex items-center gap-2 text-lg font-bold text-slate-800",children:[e(_e,{size:20,className:"text-red-600"}),s("cart_title")]}),e("button",{onClick:()=>L(!1),className:"rounded-full bg-white p-2 text-slate-400 shadow-sm transition-colors hover:bg-slate-100","aria-label":s("close_cart"),children:e(Y,{size:20})})]}),a("div",{className:"flex-1 space-y-4 overflow-y-auto p-5",children:[b.map((t,l)=>a("div",{className:"flex justify-between items-center border-b border-slate-50 last:border-0 pb-4 last:pb-0 slide-in-left delay-{idx*50}",role:"listitem",children:[a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-slate-800",children:P(t.dish)}),a("div",{className:"text-xs text-slate-400",children:["₱",t.dish.price]})]}),a("div",{className:"flex items-center gap-3 rounded-lg bg-slate-50 p-1",role:"group","aria-label":`${s("quantity_controls_for")} ${t.dish.name}`,children:[e("button",{onClick:()=>W(t.dish.id),onKeyDown:r=>pe(r,t.dish.id),className:"btn-primary flex h-8 w-8 items-center justify-center rounded bg-white text-slate-600 shadow-sm","aria-label":`${s("decrease_quantity")} ${t.dish.name}`,children:e(Ce,{size:14})}),e("span",{className:"w-4 text-center font-bold text-slate-800","aria-live":"polite",children:t.quantity}),e("button",{onClick:()=>R(t.dish),onKeyDown:r=>pe(r,t.dish.id),className:`flex h-8 w-8 items-center justify-center rounded shadow-sm ${x?.enableCustomStyling?"custom-button text-white":"bg-red-600 text-white"} btn-primary`,"aria-label":`${s("increase_quantity")} ${t.dish.name}`,children:e(G,{size:14})})]}),a("div",{className:"w-16 text-right font-bold text-slate-800",children:["₱",t.dish.price*t.quantity]})]},l)),a("div",{className:"mt-6 border-t border-slate-100 pt-4",children:[e("label",{className:"mb-2 block text-xs font-bold uppercase text-slate-500",children:s("special_requests")}),e("textarea",{value:se,onChange:t=>le(t.target.value),placeholder:s("special_requests_placeholder"),className:"h-20 w-full resize-none rounded-xl border-0 bg-slate-50 p-3 text-sm outline-none focus:ring-2 focus:ring-red-500"})]})]}),a("div",{className:"space-y-3 border-t border-slate-100 bg-slate-50/50 p-6",children:[a("div",{className:"mb-2 space-y-1",children:[a("div",{className:"flex items-center justify-between text-sm text-slate-500",children:[e("span",{children:s("subtotal")}),a("span",{children:["₱",S]})]}),H>0&&a("div",{className:"flex items-center justify-between text-sm text-slate-500",children:[e("span",{children:s("service_charge")}),a("span",{children:["₱",B.toFixed(2)]})]}),a("div",{className:"flex items-center justify-between border-t border-slate-200 pt-2 text-lg font-bold text-slate-800",children:[e("span",{children:s("total")}),a("span",{children:["₱",g.toFixed(0)]})]})]}),e("button",{onClick:Pe,disabled:b.length===0,className:"btn-primary flex w-full items-center justify-center gap-2 rounded-xl bg-red-600 py-4 text-lg font-bold text-white shadow-xl shadow-red-200 transition-transform hover:bg-red-700 active:scale-[0.98] disabled:cursor-not-allowed disabled:opacity-50",children:s("checkout")})]})]})}),q&&e("div",{className:"animate-in fade-in fixed inset-0 z-[60] flex items-end justify-center bg-slate-900/80 p-0 sm:items-center sm:p-4",children:a("div",{className:"animate-in slide-in-from-bottom-10 slide-in-up flex max-h-[90vh] w-full max-w-md flex-col overflow-hidden rounded-t-3xl bg-white sm:rounded-3xl",children:[a("div",{className:"flex items-center justify-between border-b border-slate-100 p-5",children:[e("button",{onClick:()=>F(!1),className:"-ml-2 p-2 text-slate-400 transition-colors hover:text-slate-600","aria-label":s("back_to_cart"),children:e(et,{size:20})}),e("h3",{className:"text-lg font-bold text-slate-800",children:s("cashier")}),e("div",{className:"w-8"})]}),a("div",{className:"flex-1 overflow-y-auto p-6",children:[a("div",{className:"mb-8 text-center",children:[e("p",{className:"mb-1 text-sm text-slate-500",children:s("total_amount")}),a("div",{className:"text-4xl font-bold text-slate-900",children:["₱",g.toFixed(0)]}),a("div",{className:"mt-1 text-xs text-slate-400",children:[s("reference_price"),": ≈ ¥",(g/ue).toFixed(1)]})]}),E?e("div",{className:"animate-in fade-in slide-in-from-right-4",children:E==="CASH"?a("div",{className:"space-y-6",children:[a("div",{className:"rounded-xl border border-green-100 bg-green-50 p-4 text-center",children:[e(Z,{className:"mx-auto mb-2 text-green-600",size:32}),e("h4",{className:"font-bold text-green-800",children:s("cash_payment")}),e("p",{className:"text-xs text-green-700",children:s("prepare_cash")})]}),a("div",{children:[e("label",{className:"mb-2 block text-sm font-bold text-slate-700",children:s("cash_amount_prompt")}),a("div",{className:"relative",children:[e("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 font-bold text-slate-400",children:"₱"}),e("input",{type:"number",autoFocus:!0,value:_,onChange:t=>j(t.target.value),className:"w-full rounded-xl border-2 border-slate-200 py-4 pl-10 pr-4 text-2xl font-bold outline-none transition-all focus:border-green-500 focus:ring-4 focus:ring-green-100",placeholder:s("cash_amount_placeholder")})]}),a("div",{className:"mt-3 flex gap-2 overflow-x-auto pb-2",children:[[500,1e3].map(t=>a("button",{onClick:()=>j(t.toString()),className:"rounded-lg bg-slate-100 px-4 py-2 font-bold text-slate-600 hover:bg-slate-200",children:["₱",t]},t)),e("button",{onClick:()=>j(g.toFixed(0)),className:"btn-primary rounded-lg bg-slate-100 px-4 py-2 font-bold text-slate-600 transition-colors hover:bg-slate-200",children:s("exact")})]})]}),_&&!isNaN(parseFloat(_))&&a("div",{className:"flex items-center justify-between rounded-xl bg-slate-50 p-4",children:[e("span",{className:"font-medium text-slate-500",children:s("change_due")}),a("span",{className:`text-xl font-bold ${parseFloat(_)>=g?"text-green-600":"text-red-500"}`,children:["₱",(parseFloat(_)-g).toFixed(0)]})]}),a("div",{className:"flex gap-3 pt-4",children:[e("button",{onClick:()=>y(null),className:"flex-1 rounded-xl py-3 font-bold text-slate-500 transition-colors hover:bg-slate-50",children:s("back")}),e("button",{onClick:Ne,disabled:O||(_?parseFloat(_)<g:!0),className:`flex flex-[2] items-center justify-center gap-2 rounded-xl py-3 font-bold text-white shadow-lg disabled:cursor-not-allowed disabled:opacity-50 ${x?.enableCustomStyling?"custom-button shadow-custom":"bg-green-600 shadow-green-200"} btn-primary`,children:O?s("processing"):s("confirm_cash")})]})]}):e("div",{className:"space-y-8 py-8 text-center",children:O?a("div",{className:"flex flex-col items-center",children:[e("div",{className:"mb-6 h-20 w-20 animate-spin rounded-full border-4 border-slate-200 border-t-red-600"}),e("h4",{className:"text-xl font-bold text-slate-800",children:s("processing")}),e("p",{className:"text-slate-500",children:s("waiting_payment_confirmation")})]}):a(ve,{children:[a("div",{className:"relative mx-auto mb-4 flex h-48 w-48 items-center justify-center overflow-hidden rounded-2xl border-2 border-dashed border-slate-300 bg-slate-100",children:[e(X,{size:64,className:"text-slate-400 opacity-20"}),e("div",{className:"absolute inset-0 flex items-center justify-center",children:e("p",{className:"text-xs font-bold text-slate-400",children:s("simulated_api_qr")})})]}),a("div",{children:[e("h4",{className:"mb-1 text-xl font-bold text-slate-800",children:s("scan_to_pay")}),e("p",{className:"text-sm text-slate-500",children:s("use_app").replace("{method}",E||"")})]}),a("div",{className:"flex gap-3 pt-4",children:[e("button",{onClick:()=>y(null),className:"flex-1 rounded-xl py-3 font-bold text-slate-500 transition-colors hover:bg-slate-50",children:s("back")}),e("button",{onClick:Ne,className:`flex flex-[2] items-center justify-center gap-2 rounded-xl py-3 font-bold text-white shadow-lg ${x?.enableCustomStyling?"custom-button shadow-custom":"bg-red-600 shadow-red-200"} btn-primary`,children:s("simulate_success")})]})]})})}):a("div",{className:"space-y-3",children:[e("p",{className:"mb-2 text-sm font-bold text-slate-700",children:s("select_payment_method")}),a("button",{onClick:()=>y("CASH"),className:"card-hover group flex w-full items-center gap-4 rounded-xl border-2 border-slate-100 p-4 text-left transition-all hover:border-green-500 hover:bg-green-50","aria-label":`${s("select_payment_method")} ${s("cash")}`,children:[e("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-green-100 text-green-600 transition-transform group-hover:scale-110",children:e(Z,{size:24})}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-slate-800",children:s("cash")}),e("div",{className:"text-xs text-slate-400",children:s("pay_at_counter")})]}),e(z,{size:18,className:"text-slate-300"})]}),T.gCashEnabled&&a("button",{onClick:()=>y("GCASH"),className:"card-hover group flex w-full items-center gap-4 rounded-xl border-2 border-slate-100 p-4 text-left transition-all hover:border-blue-500 hover:bg-blue-50","aria-label":`${s("select_payment_method")} GCash`,children:[e("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-blue-500 text-white transition-transform group-hover:scale-110",children:e(J,{size:24})}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-slate-800",children:"GCash"}),e("div",{className:"text-xs text-slate-400",children:s("e_wallet")})]}),e(z,{size:18,className:"text-slate-300"})]}),T.mayaEnabled&&a("button",{onClick:()=>y("MAYA"),className:"card-hover group flex w-full items-center gap-4 rounded-xl border-2 border-slate-100 p-4 text-left transition-all hover:border-green-500 hover:bg-green-50","aria-label":`${s("select_payment_method")} Maya`,children:[e("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-green-500 text-white transition-transform group-hover:scale-110",children:e(J,{size:24})}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-slate-800",children:"Maya"}),e("div",{className:"text-xs text-slate-400",children:s("e_wallet")})]}),e(z,{size:18,className:"text-slate-300"})]}),T.aliPayEnabled&&a("button",{onClick:()=>y("ALIPAY"),className:"card-hover group flex w-full items-center gap-4 rounded-xl border-2 border-slate-100 p-4 text-left transition-all hover:border-blue-400 hover:bg-blue-50","aria-label":`${s("select_payment_method")} Alipay`,children:[e("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-blue-100 text-blue-600 transition-transform group-hover:scale-110",children:e(De,{size:24})}),a("div",{className:"flex-1",children:[a("div",{className:"font-bold text-slate-800",children:["Alipay ",s("alipay")]}),e("div",{className:"text-xs text-slate-400",children:s("rmb_payment")})]}),e(z,{size:18,className:"text-slate-300"})]}),T.weChatEnabled&&a("button",{onClick:()=>y("WECHAT"),className:"card-hover group flex w-full items-center gap-4 rounded-xl border-2 border-slate-100 p-4 text-left transition-all hover:border-emerald-500 hover:bg-emerald-50","aria-label":`${s("select_payment_method")} WeChat Pay`,children:[e("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-emerald-100 text-emerald-600 transition-transform group-hover:scale-110",children:e(X,{size:24})}),a("div",{className:"flex-1",children:[a("div",{className:"font-bold text-slate-800",children:["WeChat ",s("wechat_pay")]}),e("div",{className:"text-xs text-slate-400",children:s("rmb_payment")})]}),e(z,{size:18,className:"text-slate-300"})]})]})]})]})}),U&&e(nt,{order:U,onClose:()=>de(null),onPrint:()=>ze(U)})]})};export{ut as default};
