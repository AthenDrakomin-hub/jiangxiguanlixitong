import{jsxs as a,jsx as e}from"react/jsx-runtime";import{useState as p,useMemo as N}from"react";import{Download as S,Search as A,Calendar as E,ChevronDown as O,Eye as T,X as j}from"lucide-react";import{t as s}from"./index-CHj5k0ei.js";import"react-dom/client";const P=({orders:y=[],expenses:w=[],users:C=[]})=>{const[c,b]=p("orders"),[d,L]=p(""),[r,z]=p(null),[n,g]=p(null),v=[{id:"audit_1",timestamp:new Date().toISOString(),user:"admin",action:"order_modified",details:"Modified order #1001 amount from ₱800 to ₱500",severity:"warning"},{id:"audit_2",timestamp:new Date(Date.now()-36e5).toISOString(),user:"staff_01",action:"order_voided",details:"Voided H5 order #1024",severity:"info"},{id:"audit_3",timestamp:new Date(Date.now()-72e5).toISOString(),user:"manager",action:"expense_added",details:"Added expense: ₱500 for ice procurement",severity:"info"}],o=N(()=>y.filter(t=>{const l=d===""||t.id.includes(d)||t.roomNumber&&t.roomNumber.includes(d)||t.table&&t.table.includes(d)||t.items&&t.items.length>0&&t.items.some(D=>D.name&&D.name.toLowerCase().includes(d.toLowerCase())),i=!r||new Date(t.createdAt)>=new Date(r.start)&&new Date(t.createdAt)<=new Date(r.end);return l&&i}),[y,d,r]),h=N(()=>w.filter(t=>{const l=d===""||t.description&&t.description.toLowerCase().includes(d.toLowerCase())||t.category&&t.category.toString().toLowerCase().includes(d.toLowerCase()),i=!r||new Date(t.date)>=new Date(r.start)&&new Date(t.date)<=new Date(r.end);return l&&i}),[w,d,r]),f=N(()=>v.filter(t=>{const l=d===""||t.user.toLowerCase().includes(d.toLowerCase())||t.action.toLowerCase().includes(d.toLowerCase())||t.details.toLowerCase().includes(d.toLowerCase()),i=!r||new Date(t.timestamp)>=new Date(r.start)&&new Date(t.timestamp)<=new Date(r.end);return l&&i}),[v,d,r]),u=t=>(t.items||[]).reduce((l,i)=>l+i.price*i.quantity,0),x=t=>`₱${t.toLocaleString()}`,m=t=>new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=t=>{const l=C.find(i=>i.id===t);return l?l.username:t};return a("div",{className:"space-y-6",children:[a("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-slate-900",children:s("data_viewer")}),e("p",{className:"text-slate-600",children:s("data_viewer_desc")})]}),e("div",{className:"mt-4 flex items-center gap-2 md:mt-0",children:a("button",{className:"flex items-center gap-2 rounded bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[e(S,{size:18}),s("export_data")]})})]}),e("div",{className:"rounded-lg bg-white p-4 shadow",children:a("div",{className:"flex flex-col gap-4 md:flex-row",children:[a("div",{className:"relative flex-1",children:[e(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e("input",{type:"text",placeholder:s("search_placeholder"),value:d,onChange:t=>L(t.target.value),className:"w-full rounded-lg border border-slate-300 pl-10 pr-4 py-2"})]}),e("div",{className:"flex gap-2",children:a("button",{className:"flex items-center gap-2 rounded border border-slate-300 px-3 py-2 hover:bg-slate-50",children:[e(E,{size:16}),e("span",{children:s("filter_date")}),e(O,{size:16})]})})]})}),a("div",{className:"flex border-b border-slate-200",children:[e("button",{className:`px-4 py-2 font-medium ${c==="orders"?"border-b-2 border-blue-600 text-blue-600":"text-slate-500 hover:text-slate-700"}`,onClick:()=>b("orders"),children:s("order_logs")}),e("button",{className:`px-4 py-2 font-medium ${c==="finance"?"border-b-2 border-blue-600 text-blue-600":"text-slate-500 hover:text-slate-700"}`,onClick:()=>b("finance"),children:s("finance_logs")}),e("button",{className:`px-4 py-2 font-medium ${c==="audit"?"border-b-2 border-blue-600 text-blue-600":"text-slate-500 hover:text-slate-700"}`,onClick:()=>b("audit"),children:s("audit_trails")})]}),a("div",{className:"rounded-lg bg-white p-6 shadow",children:[c==="orders"&&a("div",{children:[e("h2",{className:"mb-4 text-xl font-bold text-slate-900",children:s("order_logs")}),e("div",{className:"overflow-x-auto",children:a("table",{className:"w-full",children:[e("thead",{children:a("tr",{className:"border-b border-slate-200",children:[e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("order_id")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("time")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("location")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("source")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("amount")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("payment_status")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("staff")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("actions")})]})}),e("tbody",{children:o.length>0?o.map(t=>{const l=u(t),i=t.status==="COMPLETED"?"bg-green-100 text-green-800":t.status==="CANCELLED"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800";return a("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e("td",{className:"px-4 py-3 font-medium",children:t.id}),e("td",{className:"px-4 py-3",children:m(t.createdAt)}),e("td",{className:"px-4 py-3",children:t.roomNumber||t.table||"N/A"}),e("td",{className:"px-4 py-3",children:t.source==="h5"?s("h5_order"):s("manual_order")}),e("td",{className:"px-4 py-3 font-semibold",children:x(l)}),e("td",{className:"px-4 py-3",children:e("span",{className:`rounded px-2 py-1 text-xs ${i}`,children:s(t.status.toLowerCase())})}),e("td",{className:"px-4 py-3",children:t.staffId?_(t.staffId):"N/A"}),e("td",{className:"px-4 py-3",children:a("button",{onClick:()=>g(t),className:"flex items-center gap-1 rounded bg-blue-100 px-2 py-1 text-blue-700 hover:bg-blue-200",children:[e(T,{size:14}),s("view_details")]})})]},t.id)}):e("tr",{children:e("td",{colSpan:8,className:"px-4 py-6 text-center text-slate-500",children:s("no_orders_found")})})})]})})]}),c==="finance"&&a("div",{children:[e("h2",{className:"mb-4 text-xl font-bold text-slate-900",children:s("finance_logs")}),e("div",{className:"overflow-x-auto",children:a("table",{className:"w-full",children:[e("thead",{children:a("tr",{className:"border-b border-slate-200",children:[e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("transaction_id")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("type")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("amount")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("payment_method")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("location")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("time")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("staff")})]})}),a("tbody",{children:[o.filter(t=>t.status==="COMPLETED").map(t=>{const l=u(t);return a("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e("td",{className:"px-4 py-3 font-medium",children:t.id}),e("td",{className:"px-4 py-3",children:e("span",{className:"rounded bg-green-100 px-2 py-1 text-xs text-green-800",children:s("income")})}),a("td",{className:"px-4 py-3 font-semibold text-green-700",children:["+",x(l)]}),e("td",{className:"px-4 py-3",children:t.paymentMethod||s("cash")}),e("td",{className:"px-4 py-3",children:t.roomNumber||t.table||"N/A"}),e("td",{className:"px-4 py-3",children:m(t.createdAt)}),e("td",{className:"px-4 py-3",children:t.staffId?_(t.staffId):"N/A"})]},`income_${t.id}`)}),h&&h.map(t=>a("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e("td",{className:"px-4 py-3 font-medium",children:t.id}),e("td",{className:"px-4 py-3",children:e("span",{className:"rounded bg-red-100 px-2 py-1 text-xs text-red-800",children:s("expense")})}),a("td",{className:"px-4 py-3 font-semibold text-red-700",children:["-",x(t.amount)]}),e("td",{className:"px-4 py-3",children:s("expense")}),e("td",{className:"px-4 py-3",children:t.category}),e("td",{className:"px-4 py-3",children:m(t.date||t.createdAt)}),e("td",{className:"px-4 py-3",children:s("system")})]},`expense_${t.id}`)),o&&o.filter(t=>t.status==="COMPLETED").length===0&&h&&h.length===0&&e("tr",{children:e("td",{colSpan:7,className:"px-4 py-6 text-center text-slate-500",children:s("no_finance_records")})})]})]})})]}),c==="audit"&&a("div",{children:[e("h2",{className:"mb-4 text-xl font-bold text-slate-900",children:s("audit_trails")}),e("div",{className:"overflow-x-auto",children:a("table",{className:"w-full",children:[e("thead",{children:a("tr",{className:"border-b border-slate-200",children:[e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("timestamp")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("user")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("action")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("details")}),e("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-700",children:s("severity")})]})}),e("tbody",{children:f&&f.length>0?f.map(t=>{const l=t.severity==="error"?"bg-red-100 text-red-800":t.severity==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800";return a("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e("td",{className:"px-4 py-3",children:m(t.timestamp)}),e("td",{className:"px-4 py-3 font-medium",children:t.user}),e("td",{className:"px-4 py-3",children:e("span",{className:"rounded bg-slate-100 px-2 py-1 text-xs",children:s(t.action)||t.action})}),e("td",{className:"px-4 py-3",children:t.details}),e("td",{className:"px-4 py-3",children:e("span",{className:`rounded px-2 py-1 text-xs ${l}`,children:s(t.severity)})})]},t.id)}):e("tr",{children:e("td",{colSpan:5,className:"px-4 py-6 text-center text-slate-500",children:s("no_audit_logs")})})})]})})]})]}),n&&e("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:a("div",{className:"w-full max-w-2xl rounded-lg bg-white p-6",children:[a("div",{className:"mb-4 flex items-center justify-between",children:[a("h3",{className:"text-xl font-bold text-slate-900",children:[s("order_details")," - ",n.id]}),e("button",{onClick:()=>g(null),className:"rounded-full p-1 hover:bg-slate-100",children:e(j,{size:20})})]}),a("div",{className:"space-y-4",children:[a("div",{className:"grid grid-cols-2 gap-4",children:[a("div",{children:[e("p",{className:"text-sm text-slate-600",children:s("location")}),e("p",{className:"font-medium",children:n.roomNumber||n.table||"N/A"})]}),a("div",{children:[e("p",{className:"text-sm text-slate-600",children:s("source")}),e("p",{className:"font-medium",children:n.source==="h5"?s("h5_order"):s("manual_order")})]}),a("div",{children:[e("p",{className:"text-sm text-slate-600",children:s("time")}),e("p",{className:"font-medium",children:m(n.createdAt)})]}),a("div",{children:[e("p",{className:"text-sm text-slate-600",children:s("payment_method")}),e("p",{className:"font-medium",children:n.paymentMethod||s("cash")})]})]}),a("div",{children:[e("h4",{className:"mb-2 font-semibold",children:s("order_items")}),e("div",{className:"space-y-2",children:n&&n.items&&n.items.map((t,l)=>a("div",{className:"flex justify-between border-b pb-2",children:[a("div",{children:[e("p",{className:"font-medium",children:t.name}),a("p",{className:"text-sm text-slate-600",children:[t.quantity," x ₱",t.price.toLocaleString()]})]}),a("p",{className:"font-semibold",children:["₱",(t.price*t.quantity).toLocaleString()]})]},l))}),e("div",{className:"mt-4 flex justify-end",children:e("div",{className:"w-1/3",children:a("div",{className:"flex justify-between border-t pt-2",children:[e("p",{className:"font-semibold",children:s("total")}),e("p",{className:"font-semibold",children:n?x(u(n)):"0"})]})})})]})]})]})})]})};export{P as default};
